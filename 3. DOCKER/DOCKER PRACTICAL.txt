                                                                                        #first-practicle.

Docker Installation on AWS and important commands
___________________________________________________

  1. Create a Ubuntu machine on AWS -> update system : sudo apt-get update 
  2. install Docker if not installed:
              - sudo apt-get install docker.io  (in io package you'll get docker engine,docker demon (container d),docker CLI everything. 
</> To check whether the Docker service / Docker engine is running:
ðŸ‘‰ sudo systemctl status docker
              - sudo usermod -aG docker $USER ( without adding user in docker group you can't run Docker commands like, docker ps, docker pull etc... without using sudo ) 
                                         $user : refers to your current logged in username.
Note: - systemctl Linux ka systemd (Linux ka engine) naam ka system manager control karne ke liye command-line tool hai. systemctl kya-kya control karta hai? nginx, mysql, docker, ssh           jaise services ko start/stop/restart/manage karna.

</> after adding to group below command for refresh :
ðŸ‘‰ newgrp docker

 3. connect local machine to docker-hub :
                                - docker login 
                                - login on docker hub -> setting -> personal access token -> New access token : dkg;aj;ajg;
                                - now after token generation instead of password give token hit enter .
</> To download an image from docker-hub to a local machine :
ðŸ‘‰ docker pull <image-name>

</> To start the Docker service :
ðŸ‘‰ sudo systemctl start docker

</> To Stop the Docker service :
ðŸ‘‰ sudo systemctl stop docker

</> To restart the docker service :
ðŸ‘‰ sudo systemctl restart docker

</> To see all images present in your local :
ðŸ‘‰ docker images

</> To find out images in the docker hub :
ðŸ‘‰ docker search <image-name>

</> To give a name to the container and run :
ðŸ‘‰ docker run -it --name <container-name> <image-name> /bin/bash
Note:-  
-it => interative mode and direct to terminal 
/bin/bash => to start a bash shell inside the container

</> to Start a stopped container :
ðŸ‘‰ docker start <container-name or container-id>

</> Stop a running container :
ðŸ‘‰ docker stop <container-name or container-id>

</> To delete the container :
ðŸ‘‰ docker rm <container-name or container-id>

</> Restart a running container :
ðŸ‘‰ docker restart <container-name or container-id>

</> to see all containers :
ðŸ‘‰ docker ps -a 

</> To see only running containers.
ðŸ‘‰ docker ps

</> To delete images :
ðŸ‘‰ docker image rm <imgage-name>


                                                                  



                                                                               #second-practicle.


Dockerfile Creation
______________________

Docker image creation using existing docker file
--------------------------------------------------
hr ek chij jo FROM,WORKDIR,COPY, RUN etc dockerfile ke syntax hai.


1. create a folder any named like, javaprojects in linux -> copy url of the project from github.
   mkdir javaprojects -> hit enter
   git clone https://github.com/sahilalam/simple-java-projects
   cd simple-java-projects
now you will see the docker file, if you want few changes then open and edit. or remove and make from skratch.
rm -v Dockerfile   (-v because delete hote time dikhengi) : yha docker file removed ho gya ab 
new file bnane hai  vim DockerFile ( vim ek vi ka improved version h with extra features) dhyan rhe ki apne project ke ander hee file bna rhe hai docker ka

Dockerfile :

FROM : openjdk:17-jdk-alpin       Sbse phle dekho kon si application run krna hai ? apne case me java , to apne ko sabse phle jo chahiye wo java chahiye hoga taki java ka enviroment mil                                   ske. jiske liye v hume image chahiye hoga jisko base image bolte hai.
WORKDIR  /app    workdir mtlb aisa smjh lo ki apke host me source code rkha hua h or apka container use chlana chahta hai to uske liye apne container me ek aisa folder bnana hai jisme                            host ka source code apke container me rkha rhega.

COPY src/Main.java    /app/Main.java      hr chij jo mere host/source me rkhi hui hai wo mere container ke ander chla jaye or mera container chlne lge

RUN   javac Main.java   for compile the application code 

CMD   ["java","Main"]  cmd ek aisa special command hota hai jab ek bar apka container ban jaye or usko chlane ke liye jo command uper se apply krte hai whi kaam krta hai cmd. agar ye                           command nhi likhoge tab v container bnega , but ye command likhoge to container bnne ke bad execute v ho jayega.
                        CMD  ["java","Main"]  =   Without Docker :
                                                           javac Main.java     // compile
                                                           java Main           // run
                                                  Same inside Docker :
                                                            RUN javac Main.java  // compile
                                                            CMD ["java","Main"]  // run
      Case => Spring Boot : CMD ["java", "-jar", "app.jar"]  :  Yaha class nahi, JAR file run hota hai.

now :wq  for save and exit ab docker file ban gyi hai 

docker file se docker image bnane ki command : docker build -t <my-image-name> .  (yha . mtlb context, mtlb docker file. ki us docker file ko as a context man ke ye image ban rhi hai jo                                                                                     ki isi directory me rkhi hui hai.)

ab image ko run kro  docker run my-image-name  : you will see the output

ab source code me kuch change krte hai vim src/Main.java it will open vim editor kuch change kr do . or fir dubara se docker run my-image-name ko run kro you will see purana wala hee output so iske liye dubara se image ko v update krna pdega jab jab source code me change hoga to : docker build -t <my-image-name> .

now,suppose aap apne application ko browser se hit krna chah rhe hai to uske liye aapne portmapping kr diya or using ec2 public ip use kr rhe ab jo v url hit kr rhe usko dekhne ke liye
docker logs <container ka id> but hr hit ke bad apko logs wala command chlana pdega agr app chahte hai n chlana pde to docker attach <container-id>




                                                                                      #third-Practile

Note:- suppose i want to run mysql image for container so first i will pull from docker hub , then docker run -e MYSQL_ROOT_PASSWORD=<jo_mrji_value_dedo> mysql hit enter

now in running database i want to enter  : docker exec (means execute) -it (means interactive terminal) <container-id> bash (shell)  -> hit enter 
ab  mysql -u  root -p -> enter kro or jo password pull krte time dala tha wo do or jaise mysql ka query hota hai wo sab use kr skte ho.
ab database baher ana hai to 2bar exit krna pdega by writing exit -> hit enter then exit -> hit enter





                                                                                      #fourth-Practile

start from 1 : 21 minutes.










How to create docker file in spring boot?then Create Docker Image then? push that to docker hub?
#################################################################################################
STEP-1:
(1) create spring boot project by adding spring-web dependency.
(2) develop only restController -> create one getMapping method named printMessage() and return message like "hello-world".
(3) add finalName tag inside build tag for getting jar as clear name:  <build>
		                                                               <finalName>demo-app</finalName>
                                                                       </build>



STEP-2: 
(1) create one docker file in root path of spring boot project name should be Dockerfile.

(2) inside file add below things:

FROM openjdk:17
LABEL maintainer="Meraz Alam <merazalam987654@example.com>" // note: dimond operator should as it is.
COPY target/demo-app.jar  /usr/app/
WORKDIR /usr/app/
EXPOSE 9092
ENTRYPOINT ["java", "-jar", "demo-app.jar"]

(3) now pushed the project on github



STEP-3:
(1) create one Amazon Linux
 
(2) in that install following tools:

Docker Install And Varify:
-----------------------------
(a) docker -v / docker --version
(b) sudo yum install docker -y
(c) sudo yum update docker -y
(d) sudo usermod -aG <package-name> <group-name> / sudo usermod -aG docker ec2-user
(e) sudo systemctl status docker
(f) sudo systemctl start docker 
(g) sudo systemctl stop docker



Maven Install and varify :
-----------------------------
(a) mvn --version
(b) sudo yum install maven -y
(c) sudo yum upgrade maven -y

Git Install and Varify:
-------------------------
(a) git --version
(b) whereis git
(c) sudo yum install git -y
(d) sudo yum update git -y

(3) Clone git repo in docker host machine (linux): 
    git clone <http-url>

(4) Point to project root folder: cd <git-repo> -> <here find docker file and scr folder> 
(5) run to generate jar: mvn clean package
(6) Create docker image from .jar file following command:
      docker build -t meraz786/myhub:dev-v1 .   (here . dot is used to find that .jar file is in same path).
Note: 
meraz786 â†’ This is your Docker Hub username
test-app â†’ This is your image/repository name
v1 â†’ This is your tag (can be anything like v1, latest, etc.)

(7) docker images 

(8) run docker container: docker run -d -p 9092:9092 --name psa psait/your-app
Note:
docker run : Starts (runs) a new container from a Docker image.
-d : Runs the container in detached mode (in the background).
-p 9092:9092 : Maps ports from host to container.
--name psa : Gives the container a custom name: psa
psait/your-app : This is the Docker image name (including the Docker Hub username psait).

(9)See the image is running or not: docker ps

(10) docker logs <container-id>

(11) Access application URL in browser: http://public-ip:9092/

STEP-4:
Steps to push docker image to docker hub:-
(a) login into docker hub account from bash of same linux just run below command:
-> docker login -> (Enter username,  Enter password )

(b) push docker image:
-> docker push meraz786/myhub:<tag>
 

------------------------------------------------------------------------------------------------------------------------------------------------------------

Important Docker Commands:=
###################################
(1) docker pull <image-name>                 / ex image:- psait/pankajsiracademy:latest
(2) docker images
(3) docker run <image-name / image-id> / docker run <hello-world / 74cc54e27dc4>
(4) docker ps
(5) docker ps -a
(6) docker stop <container-id>
(7) docker start <container-id>
(8) docker rm <container-id>
(9) docker rmi <image-name / image-id> 
(10) docker system prune -a
(11) 

----------------------------------------------------------------------------------------------------------------------------------------------------------------------
Port Mapping / Port forwarding concept (How to create Docker Image and run that to access from browser?):=
##########################################################################################################
(1) Docker run -p host-port:container-port [image-name]  / docker run -p 9090:9090 [image-name]
(2) http://public-ip:host-port(linux-vm)
(3) Docker run -d -p host-port:container-port [image-name]
 
